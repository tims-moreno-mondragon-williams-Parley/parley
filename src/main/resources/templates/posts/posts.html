<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security" lang="en">
<head>
	<div th:insert="~{partials/head :: head('Posts')}"></div>
</head>
<body>
<div>
	<div th:include="~{partials/navbar.html}"></div>
</div>
<div class="left-menu-topics">
	<div th:if="${#authentication.principal.is_admin}">
		<div id="show-create-category-form-container">
			<button id="show-create-category-form-button" class="show-button">[+]</button>
			<button id="hide-create-category-form-button" class="hide-button">[-]</button>
		</div>
		<div id="create-category-form-container">
			<form th:action="@{/posts/create-category}" method="post">
				<label for="new_category_name">New Category Name</label>
				<input type="text" name="new_category_name" id="new_category_name">
				<input type="submit" th:value="Create">
			</form>
		</div>
		<div class="form-error-message">
			<p th:if="${catCreteError}" th:text="${catCreteError}"></p>
		</div>
		<div class="form-error-message">
			<p th:if="${topicCreteError}" th:text="${topicCreteError}"></p>
		</div>
	</div>
	<div th:each="category : ${categories}">
		<p th:text="${category.name}"></p>
		<div th:if="${#authentication.principal.is_admin}">
			<div class="show-create-topic-form-container">
				<button class="show-button show-create-topic-form-button">[+]</button>
				<button class="hide-button hide-create-topic-form-button">[-]</button>
			</div>
			<div class="create-topic-form-container">
				<form th:action="@{/posts/create-topic}" method="post">
					<label for="new_topic_name">New Topic Name</label>
					<input type="text" name="new_topic_name" id="new_topic_name">
					<input type="hidden" name="category_id" id="category_id" th:value="${category.id}">
					<input type="submit" th:value="Create">
				</form>
			</div>
		</div>
		<div th:each="topic : ${topics}">
			<ul th:if="${topic.getCategory().getId() == category.getId()}">
				<li>
					<a th:href="@{/posts/{id}(id=${topic.id})}" th:text="${topic.name}"></a>
				</li>
			</ul>
		</div>
	</div>
</div>

<div class="post-creation-form" th:if="${topicClicked}">
	<form th:action="@{/posts/{id}/create(id=${viewedTopic.id})}" method="post" th:object="${formPost}">
		<label for="title" >Post Title</label>
		<input type="text" id="title" name="title" th:field="*{title}">
		<label for="body">Post Body</label>
		<textarea id="body" name="body" cols="33" rows="5" th:field="*{body}"></textarea>
		<label for="position">Position</label>
		<select name="position" id="position">
			<option th:field="*{position}" th:value="a">Agree</option>
			<option th:field="*{position}" th:value="d">Disagree</option>
			<option th:field="*{position}" th:value="i">Indifferent</option>
		</select>
		<input type="submit" th:value="Post">
		<div th:if="${postError}" th:text="${newPostError}"></div>
	</form>
</div>

<div class="post-section">
	<div class="post-topic">
		<h1 th:if="${topicClicked}" th:text="${viewedTopic.name}"></h1>
		<h1 th:if="${not topicClicked}">Choose a Topic</h1>
	</div>
	<div th:replace="~{partials/post-sections :: posts('Agree', 'a')}"></div>
	<div th:replace="~{partials/post-sections :: posts('Disagree', 'd')}"></div>
	<div th:replace="~{partials/post-sections :: posts('Indifferent', 'i')}"></div>
	
</div>
</body>
</html>